<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Twitter</title>

  <!-- firebase cloud storage -->
  <script src="https://www.gstatic.com/firebasejs/4.13.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/4.13.0/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/4.13.0/firebase-storage.js"></script>


  <!-- angular -->
  <script src="vendor/angular/angular.min.js"></script>
  <script src="vendor/angular-route/angular-route.min.js"></script>
  <script src="vendor/angular-sanitize/angular-sanitize.min.js"></script>
  <script src="vendor/angular-tooltips/dist/angular-tooltips.min.js"></script>

  <!-- bootstrap -->
  <script src="vendor/jquery/dist/jquery.min.js"></script>
  <script src="vendor/bootstrap/dist/js/bootstrap.min.js"></script>

  <!--   <script src="vendor/infiniteScroll/ng-infinite-scroll.min.js"></script> -->
  <script src="vendor/jqlite/jqlite.min.js"></script>


  <!--  Angular Routing -->
  <script src="js/routing.js"></script>

  <!-- Angular main application module -->
  <script src="js/mainApp.js"></script>


  <!--  services -->
  <script src='js/userService.js'></script>
  <script src='js/posts/postsService.js'></script>
  <script src='js/messages/messagesService.js'></script>
  <script src='directives/trends/trendsService.js'></script>


  <!-- directives  -->
  <script src='directives/profile/profileDirective.js'></script>
  <script src='directives/trends/trendsDirective.js'></script>
  <script src='directives/follow/followDirective.js'></script>
  <script src='directives/footer/footerDirective.js'></script>
  <script src='directives/newPost/newPostDirective.js'></script>
  <script src='directives/post/postDirective.js'></script>
  <script src='directives/user/userDirective.js'></script>
  <script src="directives/upload-files/uploadFile.js"></script>


    <!--mainController -->
    <script src="js/mainController.js"></script>
    <script src="js/posts/postController.js"></script>
    <script src="js/profile/profileController.js"></script>
    <script src="js/settings/settingsController.js"></script>
    <script src="js/hashtag/hashtagController.js"></script>
    <script src="js/messages/messagesController.js"></script>
    <script src="directives/trends/trendsController.js"></script>
    <script src="directives/follow/followController.js"></script>

  <!-- css -->

  <link rel="shortcut icon" href="./images/icons/favicon.ico" type="image/x-icon">
  <link rel="stylesheet" href="./stylesheets/reset.css">
  <link rel="stylesheet" href="./stylesheets/fonts.css">
  <link rel="stylesheet" href="./stylesheets/header.css">
  <link rel="stylesheet" href="./stylesheets/homeAndNotifications.css">
  <link rel="stylesheet" href="./stylesheets/profile.css">
  <link rel="stylesheet" href="./stylesheets/hashtag.css">
  <link rel="stylesheet" href="./stylesheets/settings.css">
  <link rel="stylesheet" href="./stylesheets/newPostDirective.css">
  <link rel="stylesheet" href="./stylesheets/postDirective.css">
  <link rel="stylesheet" href="./stylesheets/modal.css">
  <link rel="stylesheet" href="vendor/angular-tooltips/dist/angular-tooltips.min.css">


</head>
<body ng-app="mainApp" ng-controller='mainAppController'>
    <header class='greyBorder' ng-controller='headerController'>
        <div>
      <nav id="mainNav">
        <ul>
          <li ng-controller="postController">
            <a href="#!/" class='grey' ng-click="loadPosts()">
              <img src="images/home/icons/home.png">
              <span>Home</span>
            </a>
          </li>
          <li>
            <a href="#!notifications" class='grey'>
              <img src="images/home/icons/notification.png" id='notificationImg'>
              <span>Notifications</span>
            </a>
          </li>
          <li data-toggle="modal" data-target="#messageModal" ng-click="loadConversations()" >
            <a class="grey">
              <img src="images/home/icons/messages.png">
              <span>Messages</span>
            </a>
          </li>
        </ul>
      </nav>
      <nav id="rightNav">

        <ul>
          <li>
            <a href="#!/" id='logo'>
              <img src="images/home/icons/logo.png">
            </a>
          </li>
          <li>
            <input type="text" class='greyBorder' id='search' ng-model='search' placeholder="Search Twitter" ng-click="loadUsers()">
            <ul ng-show='search' class="search-wrapper">
              <li ng-repeat="user in users | filter : {name:search}">
                <a href="#!profile/{{user.username}}">
                  <img class="greyBorder" ng-src="{{user.profilePicture}}">
                  <span>{{user.name}}</span>
                  <span>@{{user.username}}</span>
                </a>
              </li>
            </ul>
          </li>
          <li class="profile-wrapper">
            <a href="" ng-click="collapsed=!collapsed">
              <img ng-src="{{user.profilePicture}}" class='greyBorder' title="Profile and settings">
            </a>
            <ul ng-show="collapsed" id="profileMenu">
              <li ng-click="collapsed=!collapsed">
                <a href="#!profile/{{user.username}}">
                  <h1>{{user.name}}</h1>
                  <h2>@{{user.username}}</h2>
                </a>
              </li>
              <li ng-click="collapsed=!collapsed">
                <a href="#!profile/{{user.username}}">Profile</a>
              </li>
              <hr/>
              <li ng-click="collapsed=!collapsed">
                <a href="#!settings">Settings and Privacy</a>
              </li>
              <hr/>
              <li>
                <a href="/logout">Logout</a>
              </li>
            </ul>
          </li>
          <li>
            <button class='filledButton' id="tweet">Tweet</button>
          </li>
        </ul>
      </nav>
    </div>

  </header>

  <div ng-controller="postController">
    <main ng-view>
    </main>

    <!--  retweet modal -->
    <div class="modal fade" id="retweetModal" tabindex="-1" role="dialog">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h1 class="modal-title" class="retweet-modal-label">Retweet this to your followers?</h1>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class='retweet-input'>
            <input ng-model="reply" type="text" placeholder="Add a comment..." maxlength="150">
          </div>
          <post></post>
          <div class="modal-footer">
            <button type="button" class="btn btn-primary filledButton" ng-click="retweet(post)">Retweet</button>
          </div>
        </div>
      </div>
    </div>

    <!-- reply modal -->
    <div class="modal fade" id="replyModal" tabindex="-1" role="dialog">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h1 class="modal-title" class="retweet-modal-label">Reply to {{post.userName}}</h1>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <post></post>
          <div>
            <newpost></newpost>
            <button type="button" class="btn btn-primary filledButton replyButton" ng-click="replyPost(post)">Reply</button>
          </div>
        </div>
      </div>
    </div>


    <!--     post information -->
    <div class="modal fade" id="postModal" tabindex="-1" role="dialog">
      <div class="modal-dialog">
        <div class="modal-content">
          <post></post>
          <div class='modal-spans'>
            <span>{{posted}}</span>
            <br>
            <span>
              <span>{{post.retweets.length}}</span> Retweets</span>
            <span ng-click="showLikes(post)" data-toggle="modal" data-target="#likesModal">
              <span>{{post.likes.length}}</span> Likes</span>
          </div>

          <div class='retweet-input'>
            <input type="text" placeholder="Tweet your reply..." ng-model="tweetText" maxlength="150">
            <button ng-click="replyPost(post)" class="filledButton">Reply</button>
          </div>
          <ol>
            <li ng-repeat="reply in replies">
              <reply></reply>
            </li>
          </ol>
        </div>
      </div>
    </div>
  </div>

  <!--   likes modal -->
  <div class="modal fade" id="likesModal" tabindex="-1" role="dialog">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h1 class="modal-title" class="retweet-modal-label">Liked {{post.likes.length}} times</h1>
        </div>

        <ol>
          <li ng-repeat="like in postUserLikes">
            <like></like>
          </li>
        </ol>

      </div>
    </div>
  </div>

  <!-- message modal -->
  <div class="modal fade" id="messageModal" tabindex="-1" role="dialog" ng-controller="messagesController">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h1 class="modal-title" class="retweet-modal-label">Dirrect messages</h1>
          <button type="button" class="btn btn-primary filledButton" ng-click="sectionInUse = 1">New Message</button>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>

        <div class='modal-body' ng-if="userInSession.conversations.length==0">
          <h1>Send a message, get a message</h1>
          <p>Direct Messages are private conversations between you and other people on Twitter. Share Tweets, media, and more!</p>
        </div>

        <div class="start-conversation" ng-if="sectionInUse == 1">
          <h2>Send message to:</h2>
          <input type="text" class='greyBorder' id='search' ng-model='messageSearch' placeholder="Enter a name..." ng-click="loadUsers()">
          <ul ng-show='messageSearch'>
            <h2>People</h2>
            <li ng-repeat="user in users | filter : {name:messageSearch}">
              <a ng-click="startConversation(user)">
                <img class="greyBorder" ng-src="{{user.profilePicture}}">
                <div>
                  <span>{{user.name}}</span>
                  <span>@{{user.username}}</span>
                </div>
              </a>
            </li>
          </ul>
        </div>

        <div ng-if="userInSession.conversations.length>0 && sectionInUse==2" class='all-conversations'>
          <ul>
              <li ng-repeat="conversation in conversations" ng-click="startConversation(conversation.user)">
                    <a href="#!profile/{{coversation.user.username}}">
                        <img class="greyBorder" ng-src="{{conversation.user.profilePicture}}">
                    </a>
                    <a>
                      <div>
                          <div>
                              <span>{{conversation.user.name}}</span>
                              <span>@{{conversation.user.username}}</span>
                              <span ng-show="false" id="conversation-user-id">{{conversation.user._id}}</span>
                            </div>
                            <br>
                            <div>
                                {{conversation.messages[(conversation.messages.length-1)].message}}
                            </div>

                      </div>
                  
                  </a>
                </li>
          </ul>
        </div>

        <div class="message-window" ng-if="sectionInUse == 3">
          <ul>
            <li ng-repeat="m in messages">
              <div>
                  <a href="">
                      <img class="greyBorder" ng-src="{{m.profilePic}}">
                  </a>
                  <p>{{m.message}}</p>
              </div>  
            </li>
          </ul>
            <input type="text" class='greyBorder' id='search' ng-model='messageToSend' autofocus>
            <button type="button" class="btn btn-primary filledButton" ng-click="sendMessage()">Send</button>
        </div>
      </div>
    </div>
  </div>

  <!--  picture detail -->
  <div class="modal fade" id="image-modal" tabindex="-1" role="dialog">
      <div class="modal-dialog">
        <div class="modal-content image-modal-container">
          <img src="images/icons/delete-icon.png" class="delete-image" ng-click="deleteImage(galleryPic)" tooltips tooltip-side="top" tooltip-template="Delete image" />
         <img class="expanded-image" ng-src="{{galleryPic}}" />
      </div>
    </div>
  </div>

</body>

</html>